{"config":{"lang":["fr"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"Lab%2001%20-%20Mise%20en%20route/","title":"Lab 01   Mise en route","text":"<p>Bienvenue dans cette s\u00e9rie de cours sur la conception d\u2019Infrastructures de Donn\u00e9es G\u00e9ospatiales sous forme de micro services. </p> <p>L\u2019architecture finale vis\u00e9e est la suivante : </p> <p>Archi cours ENSG 2025.png</p> <p>Listez les COTS employ\u00e9s par cat\u00e9gorie : </p> <ul> <li>Coeur de m\u00e9tier</li> <li>Services de socle</li> <li>Service de support</li> <li>Services de donn\u00e9es</li> </ul>"},{"location":"Lab%2001%20-%20Mise%20en%20route/#configuration-du-lab","title":"Configuration du lab","text":"<p>Sur votre machine, assurez-vous d\u2019avoir install\u00e9 les applications suivantes : </p> <ul> <li>Chromium</li> <li>VSCode</li> </ul>"},{"location":"Lab%2001%20-%20Mise%20en%20route/#depot-github","title":"D\u00e9p\u00f4t github","text":"<p>Cr\u00e9ez un d\u00e9p\u00f4t github d\u00e9di\u00e9 \u00e0 l\u2019application. </p> <p>Cr\u00e9ez un token applicatif et conservez-le pr\u00e9cieusement, il vous sera tr\u00e8s utile pour la gestion de vos fichiers par la suite! RDV \u00e0 l\u2019URL GitHub tokens de votre compte Github. </p> <p>Cr\u00e9ez un repository public (par exemple <code>ensg-sdi-2025</code>) contenant un fichier README.md et un fichier de licence MIT. </p>"},{"location":"Lab%2001%20-%20Mise%20en%20route/#creation-du-repertoire-racine-de-vos-applications","title":"Cr\u00e9ation du r\u00e9pertoire racine de vos applications","text":"<p>Sur votre machine, naviguez \u00e0 la racine de votre espace de fichiers personnel, et cr\u00e9ez le dossier <code>~/Apps</code> destin\u00e9 \u00e0 contenir les clones de vos d\u00e9p\u00f4ts GIT. </p>"},{"location":"Lab%2001%20-%20Mise%20en%20route/#configuration-de-vscode","title":"Configuration de VSCode","text":"<p>L\u2019\u00e9diteur de code VSCode est l\u2019outil de r\u00e9f\u00e9rence, gratuit, pour la majorit\u00e9 des d\u00e9veloppeurs du monde entier depuis de nombreuses ann\u00e9es. </p> <p>Configurez l\u2019outil VSCode simplement, en int\u00e9grant GitHub : https://code.visualstudio.com/docs/sourcecontrol/intro-to-git</p> <p>Clonez votre repository github avec la commande VSCode \u201cCTRL + P suivi de git : clone\u201d, et ajoutez son r\u00e9pertoire de stockage \u00e0 l\u2019espace de travail VSCode. </p> <ul> <li>[i] Apr\u00e8s avoir ajout\u00e9 votre d\u00e9p\u00f4t initial, effectuez une modification du fichier <code>README.md</code> et faites un <code>commit</code> puis un <code>push</code> pour valider la configuration.</li> </ul>"},{"location":"Lab%2001%20-%20Mise%20en%20route/#mise-en-oeuvre-de-docker","title":"Mise en oeuvre de Docker","text":"<p>Docker\u2003est un ensemble de produits PaaS (plateforme en tant que service) qui utilisent la virtualisation au niveau du syst\u00e8me d\u2019exploitation pour fournir des logiciels dans des packages appel\u00e9s conteneurs.\u2003Les conteneurs sont isol\u00e9s les uns des autres et regroupent leurs propres logiciels, biblioth\u00e8ques et fichiers de configuration\u2003;\u2003ils peuvent communiquer entre eux via des canaux bien d\u00e9finis.\u2003Tous les conteneurs sont g\u00e9r\u00e9s par un seul noyau de syst\u00e8me d\u2019exploitation et utilisent donc moins de ressources que les machines virtuelles \u2014\u2003Source</p> <p>La conteneurisation pr\u00e9sente plusieurs avantages, notamment les suivants\u2003:</p> <ul> <li>Plusieurs conteneurs peuvent s\u2019ex\u00e9cuter sur la m\u00eame machine et chaque conteneur dans un processus isol\u00e9.</li> <li>Les conteneurs prennent moins de place que les VM.</li> <li>Vous pouvez ex\u00e9cuter des conteneurs en quelques minutes, avec moins de m\u00e9moire car ils n\u2019ont pas besoin du syst\u00e8me d\u2019exploitation complet.</li> <li>Nous pouvons d\u00e9ployer et tester des conteneurs partout.</li> </ul>"},{"location":"Lab%2001%20-%20Mise%20en%20route/#installation","title":"Installation","text":"<p>L\u2019installation de docker est tr\u00e8s intuitive pour tout utilisateur de syst\u00e8mes UNIX / Linux, et tr\u00e8s bien document\u00e9e. </p> <p>RDV sur le site de l\u2019\u00e9diteur : https://docs.docker.com/engine/install/ubuntu/</p> <ul> <li>Section  Install using the\u2003<code>apt</code>\u2003repository</li> <li>Tr\u00e8s important, ne pas oublier de d\u00e9rouler les \u00e9tapes de post-installation de docker! <ul> <li>https://docs.docker.com/engine/install/linux-postinstall/</li> </ul> </li> </ul>"},{"location":"Lab%2001%20-%20Mise%20en%20route/#docker-workshop","title":"Docker workshop","text":"<p>En guise d\u2019introduction pratique \u00e0 docker, le workshop officiel fait efficacement \u00e9cho au contenu vu en cours. RDV sur https://docs.docker.com/get-started/workshop/ et suivez le jusqu\u2019\u00e0 la partie 8 pour prendre en main en douceur votre installation de docker. </p>"},{"location":"Lab%2002%20-%20Composition%20d%27une%20IDG%20de%20base/","title":"Lab 02   Composition d'une IDG de base","text":""},{"location":"Lab%2002%20-%20Composition%20d%27une%20IDG%20de%20base/#objectifs","title":"Objectifs","text":"<p>Ce laboratoire a pour objectif de vous apprendre \u00e0 d\u00e9ployer une infrastructure de donn\u00e9es g\u00e9ospatiales en utilisant Docker Compose. \u00c0 la fin de ce lab, vous serez capables de :</p> <ul> <li>Comprendre et utiliser Docker Compose pour d\u00e9ployer plusieurs services</li> <li>Installer et configurer un serveur PostgreSQL avec PostGIS</li> <li>Administrer PostgreSQL avec pgAdmin 4</li> <li>D\u00e9ployer et configurer GeoServer</li> <li>Importer des donn\u00e9es OpenStreetMap dans PostGIS</li> </ul>"},{"location":"Lab%2002%20-%20Composition%20d%27une%20IDG%20de%20base/#prerequis","title":"Pr\u00e9requis","text":"<ul> <li>Connaissances de base en Docker</li> <li>Connaissances de base en bases de donn\u00e9es relationnelles</li> <li>Notions en syst\u00e8mes d\u2019information g\u00e9ographique (SIG)</li> <li>Docker et Docker Compose install\u00e9s sur votre machine</li> </ul>"},{"location":"Lab%2002%20-%20Composition%20d%27une%20IDG%20de%20base/#1-rappels-sur-docker-compose","title":"1. Rappels sur Docker Compose","text":"<p>Docker Compose permet d\u2019orchestrer plusieurs conteneurs Docker en d\u00e9finissant leurs configurations dans un fichier <code>docker-compose.yml</code>.</p> <p>Les avantages de Docker Compose :</p> <ul> <li>Facilit\u00e9 de d\u00e9ploiement de plusieurs services</li> <li>Gestion des d\u00e9pendances entre services</li> <li>Centralisation des configurations</li> </ul> <p>Dans ce lab, nous allons utiliser Docker Compose pour d\u00e9ployer une infrastructure de donn\u00e9es g\u00e9ospatiales compos\u00e9e de plusieurs services :</p> <ul> <li>Portainer : Interface web pour g\u00e9rer les conteneurs Docker</li> <li>PostgreSQL/PostGIS : Base de donn\u00e9es g\u00e9ospatiale</li> <li>pgAdmin 4 : Interface web pour administrer PostgreSQL</li> <li>GeoServer : Serveur de diffusion de donn\u00e9es g\u00e9ospatiales</li> </ul>"},{"location":"Lab%2002%20-%20Composition%20d%27une%20IDG%20de%20base/#2-deploiement-de-portainer","title":"2. D\u00e9ploiement de Portainer","text":"<p>Portainer permet d\u2019administrer Docker via une interface web. Nous allons d\u2019abord le d\u00e9ployer et cr\u00e9er un compte administrateur.</p>"},{"location":"Lab%2002%20-%20Composition%20d%27une%20IDG%20de%20base/#creez-le-reseau-sdi_apps","title":"Cr\u00e9ez le r\u00e9seau <code>sdi_apps</code>","text":"<p>Ce r\u00e9seau supportera l\u2019ensemble de nos services par la suite. Pour des raisons de simplification du d\u00e9veloppement (mais pas de la configuration \ud83d\ude07), les adresses IP sont fix\u00e9es pour chaque service. </p> <pre><code>docker network create --subnet=172.24.0.0/16 --driver bridge sdi_apps\n</code></pre>"},{"location":"Lab%2002%20-%20Composition%20d%27une%20IDG%20de%20base/#ajout-du-service-portainer","title":"Ajout du service Portainer","text":"<p>Ajoutez le service suivant dans <code>docker-compose.yml</code> (attention! en soi, ce n\u2019est pas du tout suffisant pour faire un fichier fonctionnel!)</p> <pre><code>  portainer:\n    image: portainer/portainer-ce\n    container_name: portainer\n    restart: always\n    expose:\n      - \"9000\"\n    volumes:\n      - /var/run/docker.sock:/var/run/docker.sock\n      - portainer_data:/data\n    networks:\n&amp;emsp; &amp;emsp; &amp;emsp; sdi_apps:\n&amp;emsp; &amp;emsp; &amp;emsp; &amp;emsp; ipv4_address: 172.24.0.22\n</code></pre> <p>Question : que devez-vous ajouter pour compl\u00e9ter cette configuration ? </p> <ul> <li>Indice : pensez aux volumes, au r\u00e9seau, et \u00e0 la structure g\u00e9n\u00e9rale d\u2019un fichier docker compose!</li> </ul>"},{"location":"Lab%2002%20-%20Composition%20d%27une%20IDG%20de%20base/#deploiement","title":"D\u00e9ploiement","text":"<p>Lancez Portainer avec :</p> <pre><code>docker-compose up -d portainer\n</code></pre> <p>Acc\u00e9dez \u00e0 l\u2019interface de Portainer : <code>http://172.24.0.22:9000</code></p> <ol> <li>Cr\u00e9ez un compte administrateur</li> <li>Connectez Portainer \u00e0 l\u2019environnement Docker local</li> </ol> <p>Quizz : qu\u2019elle est la diff\u00e9rence entre les directive <code>expose</code> et <code>ports</code> ?</p>"},{"location":"Lab%2002%20-%20Composition%20d%27une%20IDG%20de%20base/#3-installation-de-postgresql-avec-postgis","title":"3. Installation de PostgreSQL avec PostGIS","text":"<p>Nous allons maintenant ajouter un service PostgreSQL avec l\u2019extension PostGIS.</p>"},{"location":"Lab%2002%20-%20Composition%20d%27une%20IDG%20de%20base/#ajout-du-service-postgresqlpostgis","title":"Ajout du service PostgreSQL/PostGIS","text":"<p>Ajoutez le bloc suivant dans <code>docker-compose.yml</code> :</p> <pre><code>  postgis:\n    image: postgis/postgis:16-3.4\n    container_name: postgis\n    restart: always\n    expose:\n      - \"5432\"\n    environment:\n&amp;emsp; &amp;emsp; &amp;emsp; POSTGRES_DB: ensgdb\n&amp;emsp; &amp;emsp; &amp;emsp; POSTGRES_USER: ensgadmin\n&amp;emsp; &amp;emsp; &amp;emsp; POSTGRES_PASSWORD: ensgpassword\n&amp;emsp; &amp;emsp; &amp;emsp; ALLOW_IP_RANGE: 0.0.0.0/0\n&amp;emsp; &amp;emsp; &amp;emsp; FORCE_SSL: FALSE\n    volumes:\n      - postgis_data:/var/lib/postgresql/data\n    networks:\n&amp;emsp; &amp;emsp; &amp;emsp; sdi_apps:\n&amp;emsp; &amp;emsp; &amp;emsp; &amp;emsp; ipv4_address: 172.24.0.10\n</code></pre> <p>Lancez le service :</p> <pre><code>docker-compose up -d postgis\n</code></pre> <p>V\u00e9rifiez qu\u2019il fonctionne :</p> <pre><code>docker ps\n</code></pre> <p>Testez la connexion :</p> <pre><code>docker exec -it postgis psql -U ensgadmin -d ensgdb\n</code></pre>"},{"location":"Lab%2002%20-%20Composition%20d%27une%20IDG%20de%20base/#test-de-connexion-depuis-vs-code","title":"Test de connexion depuis VS Code","text":"<ol> <li>Installez l\u2019extension PostgreSQL dans VS Code.</li> <li>Ouvrez le panneau <code>PostgreSQL Explorer</code>.</li> <li>Cliquez sur <code>Add Connection</code> et renseignez :<ul> <li>Host : <code>172.24.0.10</code></li> <li>Port : <code>5432</code></li> <li>User : <code>ensgadmin</code></li> <li>Password : <code>ensgpassword</code></li> <li>Database : <code>ensgdb</code></li> </ul> </li> <li>Testez la connexion.</li> </ol>"},{"location":"Lab%2002%20-%20Composition%20d%27une%20IDG%20de%20base/#4-installation-et-configuration-de-pgadmin-4","title":"4. Installation et configuration de pgAdmin 4","text":"<p>pgAdmin est une interface web pour g\u00e9rer PostgreSQL.</p>"},{"location":"Lab%2002%20-%20Composition%20d%27une%20IDG%20de%20base/#ajout-du-service-pgadmin","title":"Ajout du service pgAdmin","text":"<p>Ajoutez le bloc suivant dans <code>docker-compose.yml</code> :</p> <pre><code>  pgadmin:\n    image: dpage/pgadmin4\n    container_name: pgadmin\n    restart: always\n    environment:\n      PGADMIN_DEFAULT_EMAIL: admin@ensg.eu\n      PGADMIN_DEFAULT_PASSWORD: ensgpassword\n    volumes:\n      - pgadmin_data:/var/lib/pgadmin\n    expose:\n      - \"5050\"\n    networks:\n&amp;emsp; &amp;emsp; &amp;emsp; sdi_apps:\n&amp;emsp; &amp;emsp; &amp;emsp; &amp;emsp; ipv4_address: 172.24.0.20\n</code></pre>"},{"location":"Lab%2002%20-%20Composition%20d%27une%20IDG%20de%20base/#deploiement_1","title":"D\u00e9ploiement","text":"<pre><code>docker-compose up -d pgadmin\n</code></pre> <p>Acc\u00e9dez \u00e0 <code>http://172.24.0.20:5050</code> et connectez-vous avec :</p> <ul> <li>Email : <code>admin@ensg.eu</code></li> <li>Mot de passe : <code>ensgpassword</code></li> </ul>"},{"location":"Lab%2002%20-%20Composition%20d%27une%20IDG%20de%20base/#installation-des-extensions-postgresql","title":"Installation des extensions PostgreSQL","text":"<p>Dans l\u2019interface pgAdmin, ex\u00e9cutez les commandes suivantes :</p> <pre><code>CREATE EXTENSION postgis;\nCREATE EXTENSION postgis_topology;\nCREATE EXTENSION hstore;\nCREATE EXTENSION pg_stat_statements;\n</code></pre>"},{"location":"Lab%2002%20-%20Composition%20d%27une%20IDG%20de%20base/#5-deploiement-et-configuration-de-geoserver","title":"5. D\u00e9ploiement et configuration de GeoServer","text":"<p>GeoServer permet de diffuser des donn\u00e9es g\u00e9ospatiales via des services OGC.</p>"},{"location":"Lab%2002%20-%20Composition%20d%27une%20IDG%20de%20base/#ajout-du-service-geoserver","title":"Ajout du service GeoServer","text":"<p>Ajoutez le bloc suivant dans <code>docker-compose.yml</code> :</p> <pre><code>  geoserver:\n    image: kartoza/geoserver\n    container_name: geoserver\n    restart: always\n    environment:\n&amp;emsp; &amp;emsp; &amp;emsp; - \"CORS_ENABLED=true\"\n&amp;emsp; &amp;emsp; &amp;emsp; - GEOSERVER_ADMIN_PASSWORD=geoserver\n&amp;emsp; &amp;emsp; &amp;emsp; - GEOSERVER_ADMIN_USER=admin\n&amp;emsp; &amp;emsp; &amp;emsp; - INITIAL_MEMORY=500M\n&amp;emsp; &amp;emsp; &amp;emsp; - MAXIMUM_MEMORY=1G\n&amp;emsp; &amp;emsp; &amp;emsp; - GEOSERVER_DATA_DIR=/opt/geoserver/data_dir\n&amp;emsp; &amp;emsp; &amp;emsp; - GEOWEBCACHE_CACHE_DIR=/opt/geoserver/data_dir/gwc\n&amp;emsp; &amp;emsp; &amp;emsp; - ROOT_WEBAPP_REDIRECT=true\n&amp;emsp; &amp;emsp; &amp;emsp; - TOMCAT_EXTRAS=false\n&amp;emsp; &amp;emsp; &amp;emsp; - SAMPLE_DATA=false\n&amp;emsp; &amp;emsp; &amp;emsp; # Extensions set to be installed\n&amp;emsp; &amp;emsp; &amp;emsp; - \"INSTALL_EXTENSIONS=true\"\n&amp;emsp; &amp;emsp; &amp;emsp; - STABLE_EXTENSIONS=css-plugin,importer-plugin,wmts-multi-dimensional-plugin\n&amp;emsp; &amp;emsp; &amp;emsp; - COMMUNITY_EXTENSIONS=backup-restore-plugin,ogcapi-plugin,smart-data-loader-plugin,wmts-styles-plugin\n    expose:\n      - \"8080\"\n    volumes:\n      - geoserver_data:/opt/geoserver/data_dir\n&amp;emsp; &amp;emsp; &amp;emsp; - geoserver_bal:/opt/geoserver/data_dir/_BAL_\n&amp;emsp; &amp;emsp; &amp;emsp; - geoserver_settings:/settings\n&amp;emsp; &amp;emsp; networks:\n&amp;emsp; &amp;emsp; &amp;emsp; sdi_apps:\n&amp;emsp; &amp;emsp; &amp;emsp; &amp;emsp; ipv4_address: 172.24.0.11\n</code></pre>"},{"location":"Lab%2002%20-%20Composition%20d%27une%20IDG%20de%20base/#deploiement_2","title":"D\u00e9ploiement","text":"<pre><code>docker-compose up -d geoserver\n</code></pre> <p>Acc\u00e9dez \u00e0 <code>http://172.24.0.11:8080/geoserver</code> et connectez-vous avec :</p> <ul> <li>Utilisateur : <code>admin</code></li> <li>Mot de passe : <code>geoserver</code></li> </ul>"},{"location":"Lab%2002%20-%20Composition%20d%27une%20IDG%20de%20base/#connexion-a-postgresql","title":"Connexion \u00e0 PostgreSQL","text":"<ol> <li>Dans GeoServer, allez dans <code>Stores &gt; Add new Store</code></li> <li>Choisissez <code>PostGIS</code></li> <li>Remplissez les champs :<ul> <li>Database : <code>ensgdb</code></li> <li>User : <code>ensgadmin</code></li> <li>Password : <code>ensgpassword</code></li> <li>Host : <code>postgis</code></li> <li>Port : <code>5432</code></li> </ul> </li> <li>Cliquez sur <code>Save</code></li> </ol>"},{"location":"Lab%2002%20-%20Composition%20d%27une%20IDG%20de%20base/#6-import-de-donnees-openstreetmap-dans-postgis","title":"6. Import de donn\u00e9es OpenStreetMap dans PostGIS","text":"<p>Nous allons importer des donn\u00e9es OSM de la r\u00e9gion Bretagne dans PostGIS.</p>"},{"location":"Lab%2002%20-%20Composition%20d%27une%20IDG%20de%20base/#telechargement-des-donnees","title":"T\u00e9l\u00e9chargement des donn\u00e9es","text":"<pre><code>wget https://download.geofabrik.de/europe/france/bretagne-latest.osm.pbf\n</code></pre>"},{"location":"Lab%2002%20-%20Composition%20d%27une%20IDG%20de%20base/#installation-de-osm2pgsql","title":"Installation de osm2pgsql","text":"<pre><code>sudo apt install osm2pgsql\n</code></pre>"},{"location":"Lab%2002%20-%20Composition%20d%27une%20IDG%20de%20base/#importation-des-donnees-dans-postgis","title":"Importation des donn\u00e9es dans PostGIS","text":"<pre><code>osm2pgsql -d ensgdb -U ensgadmin -H 172.24.0.10 -P 5432 -W --create --slim --hstore bretagne-latest.osm.pbf\n</code></pre>"},{"location":"Lab%2002%20-%20Composition%20d%27une%20IDG%20de%20base/#verification","title":"V\u00e9rification","text":"<pre><code>SELECT * FROM planet_osm_point LIMIT 10;\n</code></pre>"},{"location":"Lab%2002%20-%20Composition%20d%27une%20IDG%20de%20base/#quiz-final","title":"Quiz Final","text":"<ol> <li> <p>O\u00f9 se situent physiquement les donn\u00e9es OSM import\u00e9es ?</p> <ul> <li> <p>Quelle notion de Docker permet de conserver les donn\u00e9es d\u2019un conteneur apr\u00e8s son arr\u00eat ?</p> </li> <li> <p>Comment retrouver le chemin des volumes Docker sur votre machine ?</p> </li> </ul> </li> <li> <p>Quelle est la taille des images, des conteneurs et des volumes ?</p> <ul> <li> <p>Quelle commande permet d\u2019afficher la taille des images Docker ?</p> </li> <li> <p>Quelle commande permet de voir la taille des volumes Docker ?</p> </li> <li> <p>O\u00f9 peut-on retrouver ces informations dans Portainer ?</p> </li> </ul> </li> <li> <p>Comment optimiser la taille des images Docker ?</p> <ul> <li> <p>Quels sont les \u00e9l\u00e9ments qui influencent la taille d\u2019une image Docker ?</p> </li> <li> <p>Quelles strat\u00e9gies peuvent \u00eatre mises en place pour r\u00e9duire la taille des images ?</p> </li> <li> <p>Que pensez-vous des images multi-stage builds dans ce contexte ?</p> </li> </ul> </li> </ol> <p>R\u00e9pondez aux questions en ex\u00e9cutant les commandes n\u00e9cessaires et en r\u00e9fl\u00e9chissant aux bonnes pratiques d\u2019optimisation. \ud83d\ude80</p>"},{"location":"Lab%2002%20-%20Composition%20d%27une%20IDG%20de%20base/#conclusion","title":"Conclusion","text":"<p>F\u00e9licitations ! Vous avez mis en place une infrastructure de donn\u00e9es g\u00e9ospatiales avec Docker Compose. Vous pouvez maintenant exploiter ces donn\u00e9es dans vos applications SIG.</p>"},{"location":"Lab%2003%20-%20Organiser%20sa%20configuration/","title":"Lab 03   Organiser sa configuration","text":""},{"location":"Lab%2003%20-%20Organiser%20sa%20configuration/#objectifs","title":"Objectifs","text":"<p>Ce lab a pour objectif d\u2019am\u00e9liorer l\u2019organisation et la gestion de votre infrastructure de donn\u00e9es g\u00e9ospatiales en utilisant :</p> <ul> <li>Un fichier <code>.env</code> pour centraliser les variables de configuration</li> <li>Un <code>Makefile</code> pour simplifier l\u2019ex\u00e9cution des commandes courantes</li> </ul>"},{"location":"Lab%2003%20-%20Organiser%20sa%20configuration/#1-centralisation-des-variables-dans-un-fichier-env","title":"1. Centralisation des variables dans un fichier <code>.env</code>","text":"<p>Nous allons extraire les variables de configuration de <code>docker-compose.yml</code> et les placer dans un fichier <code>.env</code>.</p>"},{"location":"Lab%2003%20-%20Organiser%20sa%20configuration/#creation-du-fichier-env","title":"Cr\u00e9ation du fichier <code>.env</code>","text":"<p>Cr\u00e9ez un fichier <code>.env</code> \u00e0 la racine de votre projet et ajoutez les lignes suivantes :</p> <pre><code>#\n# -&gt; Project name\nCOMPOSE_PROJECT_NAME=ensg-sdi\n\n# -&gt; Proxy docker networks\n# &amp;emsp;- APPS_NETWORK will be the network name you use in deployed compose services\nAPPS_NETWORK=sdi_apps\n\n# -&gt; PostGIS\n# kartoza/postgis env variables https://github.com/kartoza/docker-postgis\nPOSTGIS_VERSION=16-3.4\nPOSTGRES_DB=ensgdb\nPOSTGRES_USER=ensgadmin\nPOSTGRES_PASS=ensgpassword\nALLOW_IP_RANGE=0.0.0.0/0\nPOSTGRES_PORT=32767\n# -&gt; pgAdmin4\nPGADMIN_DEFAULT_EMAIL=admin@ensg.eu\nPGADMIN_DEFAULT_PASSWORD=ensgpassword\n\n# -&gt; Geoserver\nGS_VERSION=2.24.2\nGEOSERVER_ADMIN_USER=admin\nGEOSERVER_ADMIN_PASSWORD=geoserver\n# https://docs.geoserver.org/latest/en/user/datadirectory/setting.html\nGEOSERVER_DATA_DIR=/opt/geoserver/data_dir\n# https://docs.geoserver.org/latest/en/user/geowebcache/config.html#changing-the-cache-directory\nGEOWEBCACHE_CACHE_DIR=/opt/geoserver/data_dir/gwc\n# Show the tomcat manager in the browser\nTOMCAT_EXTRAS=false\nROOT_WEBAPP_REDIRECT=true\n# https://docs.geoserver.org/stable/en/user/production/container.html#optimize-your-jvm\nINITIAL_MEMORY=500M\nMAXIMUM_MEMORY=1G\n# Data and extensions\nSAMPLE_DATA=false\n# Full compatibility list : https://github.com/kartoza/docker-geoserver/blob/master/build_data/ Look for *_plugins.txt\nSTABLE_EXTENSIONS=css-plugin,importer-plugin,wmts-multi-dimensional-plugin\nCOMMUNITY_EXTENSIONS=backup-restore-plugin,ogcapi-plugin,smart-data-loader-plugin,wmts-styles-plugin\n</code></pre>"},{"location":"Lab%2003%20-%20Organiser%20sa%20configuration/#modification-de-docker-composeyml","title":"Modification de <code>docker-compose.yml</code>","text":"<p>Modifiez votre <code>docker-compose.yml</code> pour utiliser ces variables :</p> <pre><code>environment:\n  POSTGRES_DB: ${POSTGRES_DB}\n  POSTGRES_USER: ${POSTGRES_USER}\n  POSTGRES_PASSWORD: ${POSTGRES_PASSWORD}\n</code></pre> <p>Faites de m\u00eame pour pgAdmin et GeoServer, pour l\u2019ensemble des variables d\u2019environnement</p>"},{"location":"Lab%2003%20-%20Organiser%20sa%20configuration/#2-creation-dun-makefile-pour-automatiser-les-taches","title":"2. Cr\u00e9ation d\u2019un <code>Makefile</code> pour automatiser les t\u00e2ches","text":"<p>Nous allons maintenant cr\u00e9er un <code>Makefile</code> pour simplifier l\u2019ex\u00e9cution des commandes Docker Compose.</p>"},{"location":"Lab%2003%20-%20Organiser%20sa%20configuration/#creation-du-fichier-makefile","title":"Cr\u00e9ation du fichier <code>Makefile</code>","text":"<p>Cr\u00e9ez un fichier <code>Makefile</code> \u00e0 la racine du projet et ajoutez les commandes suivantes :</p> <pre><code># Charge les variables d'environnement\ninclude .env\nexport $(shell sed 's/=.*//' .env)\n\n# Lancement des services\nup:\n\tdocker-compose up -d\n\ndown:\n\tdocker-compose down\n\nrestart:\n\tdocker-compose restart\n\nlogs:\n\tdocker-compose logs -f\n\nps:\n\tdocker-compose ps\n\nclean:\n\tdocker system prune -f\n</code></pre>"},{"location":"Lab%2003%20-%20Organiser%20sa%20configuration/#utilisation-du-makefile","title":"Utilisation du <code>Makefile</code>","text":"<p>Ex\u00e9cutez les commandes suivantes pour tester :</p> <pre><code>make up\nmake logs\nmake ps\nmake down\n</code></pre>"},{"location":"Lab%2003%20-%20Organiser%20sa%20configuration/#3-verification-et-tests","title":"3. V\u00e9rification et tests","text":"<ol> <li> <p>V\u00e9rifiez que <code>docker-compose</code> charge bien les variables de <code>.env</code> :</p> <pre><code>docker-compose config\n</code></pre> </li> <li> <p>Assurez-vous que votre infrastructure se lance correctement avec <code>make up</code></p> </li> <li>Testez la connexion \u00e0 PostgreSQL et pgAdmin</li> </ol>"},{"location":"Lab%2003%20-%20Organiser%20sa%20configuration/#4-quizz","title":"4. Quizz","text":"<ol> <li>O\u00f9 se trouvent maintenant les variables d\u2019environnement de notre infrastructure ?</li> <li>Quelle commande permet de lister les services en cours d\u2019ex\u00e9cution ?</li> <li>Quelle commande du <code>Makefile</code> permet de red\u00e9marrer les services ?</li> <li>Comment \u00e9viter d\u2019avoir des fichiers de configuration sensibles dans un d\u00e9p\u00f4t Git ?</li> <li>Quelle est la commande pour voir la configuration compl\u00e8te apr\u00e8s interpolation des variables d\u2019environnement dans <code>docker-compose.yml</code> ?</li> </ol>"},{"location":"Lab%2003%20-%20Organiser%20sa%20configuration/#conclusion","title":"Conclusion","text":"<p>Vous avez maintenant une infrastructure mieux organis\u00e9e avec un <code>.env</code> pour centraliser les configurations et un <code>Makefile</code> pour automatiser les t\u00e2ches courantes ! \ud83c\udf89</p>"},{"location":"Lab%2004%20-%20Importer%20des%20donn%C3%A9es/","title":"Lab 04   Importer des donn\u00e9es","text":""},{"location":"Lab%2004%20-%20Importer%20des%20donn%C3%A9es/#objectifs","title":"Objectifs","text":"<p>Dans ce lab, vous allez :</p> <ul> <li>Ajouter un service FileServer dans <code>docker-compose.yml</code> pour exposer les volumes des conteneurs</li> <li>Importer des donn\u00e9es OpenStreetMap (OSM) sur Saint-Malo</li> <li>Installer et activer l\u2019extension pgRouting pour le r\u00e9seau routier</li> <li>Styliser les points d\u2019int\u00e9r\u00eat (POI) dans GeoServer</li> <li>T\u00e9l\u00e9charger et int\u00e9grer des donn\u00e9es raster marines depuis DataShom</li> </ul>"},{"location":"Lab%2004%20-%20Importer%20des%20donn%C3%A9es/#1-ajout-de-fileserver-dans-docker-composeyml","title":"1. Ajout de FileServer dans <code>docker-compose.yml</code>","text":"<p>Nous allons ajouter un service <code>filebrowser</code> qui permettra d\u2019acc\u00e9der aux volumes depuis une interface web.</p>"},{"location":"Lab%2004%20-%20Importer%20des%20donn%C3%A9es/#modification-du-fichier-docker-composeyml","title":"Modification du fichier <code>docker-compose.yml</code>","text":"<p>Ajoutez le bloc suivant :</p> <pre><code>  filebrowser:\n    image: hurlenko/filebrowser\n    container_name: filebrowser\n    restart: always\n    expose:\n      - \"8081:80\"\n    environment:\n      - PUID=1000\n      - PGID=1000\n      - FB_BASEURL=/data\n    volumes:\n      - postgis_data:/data/postgis\n      - geoserver_data:/data/geoserver\n      - geoserver_styles:/data/geoserver/styles\n      - osm_data:/data/osm\n    networks:\n      sdi_apps:\n        ipv4_address: 172.24.0.21\n</code></pre> <p>Lancez le service :</p> <pre><code>docker-compose up -d filebrowser\n</code></pre> <p>Acc\u00e9dez \u00e0 l\u2019interface : http://localhost:8081</p>"},{"location":"Lab%2004%20-%20Importer%20des%20donn%C3%A9es/#2-import-des-donnees-openstreetmap-sur-saint-malo","title":"2. Import des donn\u00e9es OpenStreetMap sur Saint-Malo","text":"<p>Nous allons r\u00e9cup\u00e9rer et importer les donn\u00e9es OSM via <code>osm2pgsql</code>.</p>"},{"location":"Lab%2004%20-%20Importer%20des%20donn%C3%A9es/#21-telechargement-des-donnees-osm","title":"2.1 T\u00e9l\u00e9chargement des donn\u00e9es OSM","text":"<pre><code>wget https://download.geofabrik.de/europe/france/bretagne-latest.osm.pbf -O saint-malo.osm.pbf\n</code></pre>"},{"location":"Lab%2004%20-%20Importer%20des%20donn%C3%A9es/#22-installation-de-osm2pgsql","title":"2.2 Installation de <code>osm2pgsql</code>","text":"<p>Si ce n\u2019est pas encore fait :</p> <pre><code>sudo apt install osm2pgsql\n</code></pre>"},{"location":"Lab%2004%20-%20Importer%20des%20donn%C3%A9es/#23-activation-de-lextension-pgrouting","title":"2.3 Activation de l\u2019extension <code>pgRouting</code>","text":"<p>Dans <code>pgAdmin</code>, ex\u00e9cutez :</p> <pre><code>CREATE EXTENSION pgrouting;\n</code></pre>"},{"location":"Lab%2004%20-%20Importer%20des%20donn%C3%A9es/#24-import-du-reseau-routier","title":"2.4 Import du r\u00e9seau routier","text":"<pre><code>osm2pgsql -d ensgdb -U ensgadmin -H localhost -P 5432 -W --create --slim --hstore --prefix saintmalo saint-malo.osm.pbf\n</code></pre> <p>V\u00e9rification :</p> <pre><code>SELECT * FROM saintmalo_line WHERE highway IS NOT NULL LIMIT 10;\n</code></pre> <p>Autres possibilit\u00e9: </p> <pre><code>SELECT highway, ST_AsText(way) FROM planet_osm_line LIMIT 10;\n</code></pre>"},{"location":"Lab%2004%20-%20Importer%20des%20donn%C3%A9es/#25-ajout-dun-style-sld-dans-geoserver","title":"2.5 Ajout d\u2019un style SLD dans geoserver","text":"<p>Cr\u00e9ez un fichier <code>osm_roads.sld</code> et ajoutez le code suivant :</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;StyledLayerDescriptor version=\"1.0.0\"\n    xmlns=\"http://www.opengis.net/sld\"\n    xmlns:ogc=\"http://www.opengis.net/ogc\"\n    xmlns:xlink=\"http://www.w3.org/1999/xlink\"\n    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n    xsi:schemaLocation=\"http://www.opengis.net/sld StyledLayerDescriptor.xsd\"&gt;\n    \n    &lt;NamedLayer&gt;\n        &lt;Name&gt;osm_roads&lt;/Name&gt;\n        &lt;UserStyle&gt;\n            &lt;Title&gt;OSM Road Styles&lt;/Title&gt;\n            &lt;FeatureTypeStyle&gt;\n                &lt;!-- Autoroutes --&gt;\n                &lt;Rule&gt;\n                    &lt;Name&gt;Motorway&lt;/Name&gt;\n                    &lt;Title&gt;Autoroutes&lt;/Title&gt;\n                    &lt;ogc:Filter&gt;\n                        &lt;ogc:PropertyIsEqualTo&gt;\n                            &lt;ogc:PropertyName&gt;highway&lt;/ogc:PropertyName&gt;\n                            &lt;ogc:Literal&gt;motorway&lt;/ogc:Literal&gt;\n                        &lt;/ogc:PropertyIsEqualTo&gt;\n                    &lt;/ogc:Filter&gt;\n                    &lt;LineSymbolizer&gt;\n                        &lt;Stroke&gt;\n                            &lt;CssParameter name=\"stroke\"&gt;#ff0000&lt;/CssParameter&gt;\n                            &lt;CssParameter name=\"stroke-width\"&gt;5&lt;/CssParameter&gt;\n                        &lt;/Stroke&gt;\n                    &lt;/LineSymbolizer&gt;\n                &lt;/Rule&gt;\n                \n                &lt;!-- Routes principales --&gt;\n                &lt;Rule&gt;\n                    &lt;Name&gt;Primary&lt;/Name&gt;\n                    &lt;Title&gt;Routes primaires&lt;/Title&gt;\n                    &lt;ogc:Filter&gt;\n                        &lt;ogc:PropertyIsEqualTo&gt;\n                            &lt;ogc:PropertyName&gt;highway&lt;/ogc:PropertyName&gt;\n                            &lt;ogc:Literal&gt;primary&lt;/ogc:Literal&gt;\n                        &lt;/ogc:PropertyIsEqualTo&gt;\n                    &lt;/ogc:Filter&gt;\n                    &lt;LineSymbolizer&gt;\n                        &lt;Stroke&gt;\n                            &lt;CssParameter name=\"stroke\"&gt;#ff9900&lt;/CssParameter&gt;\n                            &lt;CssParameter name=\"stroke-width\"&gt;4&lt;/CssParameter&gt;\n                        &lt;/Stroke&gt;\n                    &lt;/LineSymbolizer&gt;\n                &lt;/Rule&gt;\n            &lt;/FeatureTypeStyle&gt;\n        &lt;/UserStyle&gt;\n    &lt;/NamedLayer&gt;\n&lt;/StyledLayerDescriptor&gt;\n</code></pre>"},{"location":"Lab%2004%20-%20Importer%20des%20donn%C3%A9es/#3-import-du-style-dans-geoserver","title":"3. Import du style dans GeoServer","text":"<ol> <li>Acc\u00e9dez \u00e0 l\u2019interface web de GeoServer : <code>http://geoserver.local/web/</code></li> <li>Allez dans Styles et cliquez sur Ajouter un style</li> <li>Choisissez le format SLD, puis copiez-collez le contenu du fichier <code>osm_roads.sld</code></li> <li>Cliquez sur Valider pour vous assurer qu\u2019il n\u2019y a pas d\u2019erreur</li> <li>Enregistrez le style</li> </ol>"},{"location":"Lab%2004%20-%20Importer%20des%20donn%C3%A9es/#4-application-du-style-a-la-couche","title":"4. Application du Style \u00e0 la Couche","text":"<ol> <li>Allez dans Couches </li> <li>S\u00e9lectionnez la couche contenant les routes OSM</li> <li>Cliquez sur Modifier et appliquez le style <code>osm_roads</code> </li> <li>Sauvegardez les modifications</li> <li>V\u00e9rifiez le rendu sur l\u2019aper\u00e7u GeoServer</li> </ol>"},{"location":"Lab%2004%20-%20Importer%20des%20donn%C3%A9es/#verification-et-ajustements","title":"V\u00e9rification et Ajustements","text":"<ul> <li>Si certaines routes ne s\u2019affichent pas correctement, v\u00e9rifiez les valeurs <code>highway</code> dans la base PostGIS</li> <li>Adaptez les couleurs et \u00e9paisseurs en fonction du rendu souhait\u00e9</li> <li>Testez l\u2019affichage sur MapStore2 ou un client GIS compatible WMS</li> </ul>"},{"location":"Lab%2004%20-%20Importer%20des%20donn%C3%A9es/#quizz","title":"Quizz","text":"<ol> <li>O\u00f9 sont stock\u00e9es physiquement les donn\u00e9es OSM import\u00e9es dans PostGIS ?</li> <li>Quel est l\u2019int\u00e9r\u00eat d\u2019utiliser <code>pgRouting</code> pour les donn\u00e9es routi\u00e8res ?</li> <li>Comment r\u00e9duire la taille des fichiers raster dans GeoServer ?</li> <li>Quels sont les avantages d\u2019un serveur de fichiers comme FileServer dans une infrastructure Docker ?</li> </ol> <p>F\u00e9licitations ! \ud83c\udf89 Vous avez appris \u00e0 structurer et visualiser des donn\u00e9es g\u00e9ospatiales avec Docker et GeoServer.</p>"},{"location":"blog/","title":"Index","text":""},{"location":"blog/#blog","title":"Blog","text":""}]}